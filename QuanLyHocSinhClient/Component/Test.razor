@page "/timetable"
@using System.Globalization
@*<TitleTimetable></TitleTimetable>*@
@for (int i = 0; i < 6; i++)
{
    int index = i;
    <Timetable title="@ConvertDateToString(monday.AddDays(index))" scheduleDetails="@getScheduleDetailByDay(monday.AddDays(index))"></Timetable>
}
@*<Timetable title="@(title.DayOfWeek +", Ngay"+ title.ToString("dd/MM/yyyy"))" scheduleDetails="@scheduleDetails"></Timetable>
<Timetable title="Thứ 3, Ngày 15/11/2021" scheduleDetails="@scheduleDetails"></Timetable>*@
@*@foreach(var item in scheduleDetails)
    {
        <p>@item.SubjectId</p>
    }*@
@code {
    List<Schedule> listModel = new List<Schedule>();
    DateTime title;
    DateTime monday = DateTime.Now.AddDays(-1 * (7 + (DateTime.Now.DayOfWeek - DayOfWeek.Monday)) % 7).Date;

    //List<Subject> subjects = new
    List<ScheduleDetail> scheduleDetails = new List<ScheduleDetail>();

    protected async override Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        string param = "25112021";
        //listModel = await API<List<Schedule>>.QLTKB.GetAsync("/api/Su");
        scheduleDetails = await API<List<ScheduleDetail>>.QLHocSinh.GetAsync($"/api/ScheduleDetails/scheduleDetailByDate/{param}");

    }
    string ConvertDateToString(DateTime dateTime)
    {
        var param = dateTime.ToString("ddMMyyyy");
        title = DateTime.ParseExact(param, "ddMMyyyy", CultureInfo.InvariantCulture);
        return title.DayOfWeek + ", Ngay" + title.ToString("dd/MM/yyyy");
    }
      List<ScheduleDetail> getScheduleDetailByDay(DateTime dateTime)
        {
            var param = dateTime.ToString("ddMMyyyy");
            return  API<List<ScheduleDetail>>.QLHocSinh.GetAsync($"/api/ScheduleDetails/scheduleDetailByDate/{param}").Result;
        }
}